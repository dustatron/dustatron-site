---
import { getCollection } from "astro:content";
import Layout from "@/layouts/Layout.astro";
import BlogHeader from "@/components/BlogHeader.astro";

const posts = (await getCollection("blog"))
  .filter((post) => !post.data.draft)
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());

const formatDate = (date: Date) => {
  return date.toLocaleDateString("en-US", {
    year: "numeric",
    month: "long",
    day: "numeric",
  });
};
---

<Layout title="Blog | Dusty McCord" description="Thoughts on web development, React, TypeScript, and frontend engineering.">
  <BlogHeader />
  <main class="pt-24 pb-16 px-4">
    <div class="max-w-3xl mx-auto">
      <h1 class="text-4xl font-bold mb-2 text-foreground">Blog</h1>
      <p class="text-muted-foreground mb-8">
        Thoughts on web development, React, TypeScript, and frontend engineering.
      </p>

      <div class="space-y-6">
        {posts.length === 0 && (
          <p class="text-muted-foreground">No posts yet. Check back soon!</p>
        )}
        {posts.map((post) => (
          <a
            href={`/blog/${post.id}`}
            class="block backdrop-blur-md bg-white/10 dark:bg-white/5 rounded-xl border border-white/20 dark:border-white/10 shadow-lg p-6 hover:bg-white/20 dark:hover:bg-white/10 transition-colors"
          >
            <article>
              <h2 class="text-xl font-semibold text-foreground mb-2 group-hover:text-primary">
                {post.data.title}
              </h2>
              <p class="text-muted-foreground text-sm mb-3">
                {formatDate(post.data.pubDate)}
              </p>
              <p class="text-foreground/80">
                {post.data.description}
              </p>
              {post.data.tags.length > 0 && (
                <div class="flex flex-wrap gap-2 mt-4">
                  {post.data.tags.map((tag) => (
                    <span class="text-xs px-2 py-1 rounded-full bg-primary/10 text-primary">
                      {tag}
                    </span>
                  ))}
                </div>
              )}
            </article>
          </a>
        ))}
      </div>
    </div>
  </main>
</Layout>
